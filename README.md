# DM Compass - Diabetes Ward OS

初期研修医向けの糖尿病病棟管理判断支援Webアプリケーション

## 概要

**DM Compass**は、初期研修医1年目が糖尿病病棟で必要な医学知識と計算をサポートするスマートフォン専用Webアプリです。必要エネルギー計算、腎症ステージ判定、インスリン混注計算などの判断支援ツール（CALC）と、インスリン製剤・経口薬・分類・合併症などの医学情報ガイド（GUIDE）を搭載しています。

## 主な機能

### CALC - 計算ツール

1. **必要エネルギー計算**
   - 身長と活動量から標準体重と1日必要カロリーを自動計算
   - 1食あたりのカロリー目安も表示

2. **糖尿病性腎症ステージ判定**
   - eGFRから腎症ステージ（第1～5期）を自動判定
   - 推奨蛋白摂取量と1日推奨蛋白量を表示

3. **末梢糖含有輸液インスリン混注計算**
   - 輸液の総糖量からインスリン単位を計算
   - 5g/単位と10g/単位の両方を表示

4. **IVH混注計算**
   - IVH製剤の総糖量からインスリン単位を計算
   - 10g/単位と15g/単位の両方を表示（持続投与対応）

5. **スライディングスケール作成**
   - 体重と重症度から血糖値別補正インスリン表を自動生成
   - 軽症・中等度・高度の3パターンに対応

### GUIDE - 医学情報ガイド

1. **インスリン製剤一覧**
   - 超超速効型からアナログ混合型、週1回基礎まで全分類
   - 各製剤の作用発現、ピーク、持続時間を記載

2. **経口血糖降下薬一覧**
   - ビグアナイド、SGLT2阻害薬、DPP-4阻害薬、GLP-1受容体作動薬、SU薬、グリニド、α-GI、チアゾリジン
   - 禁忌と周術期休薬情報を記載

3. **糖尿病分類**
   - 1型糖尿病（劇症、急性発症、緩徐進行）
   - 2型糖尿病
   - その他（MODY、ミトコンドリア糖尿病、二次性）

4. **合併症ガイド**
   - 細血管障害（網膜症、腎症、神経障害）
   - 大血管障害（冠動脈疾患、脳血管障害、末梢動脈疾患）

## UI/デザイン

- **スマートフォン最適化**：縦長レイアウト、1画面完結設計
- **配色**：完全黒背景（#000000）、白文字（#FFFFFF）
- **アクセント色**：
  - CALCボタン：緑（#10b981）
  - GUIDEボタン：青（#3b82f6）
- **UI要素**：カード型デザイン、視認性優先

## 技術スタック

- **フロントエンド**：React 19 + TypeScript + Tailwind CSS 4
- **バックエンド**：Express 4 + tRPC 11
- **データベース**：MySQL + Drizzle ORM
- **認証**：Manus OAuth
- **ホスティング**：Manus

## プロジェクト構成

```
dm-compass/
├── client/
│   ├── src/
│   │   ├── pages/
│   │   │   ├── Home.tsx          # ホーム画面
│   │   │   ├── CalcPage.tsx      # CALC計算ツール
│   │   │   └── GuidePage.tsx     # GUIDE医学情報
│   │   ├── App.tsx               # ルート定義
│   │   ├── index.css             # グローバルスタイル
│   │   └── main.tsx              # エントリーポイント
│   └── public/
├── server/
│   ├── routers.ts                # tRPCプロシージャ定義
│   ├── db.ts                     # データベースヘルパー
│   ├── calc.test.ts              # ユニットテスト
│   └── _core/                    # フレームワークコア
├── drizzle/
│   ├── schema.ts                 # データベーススキーマ
│   └── migrations/               # マイグレーションファイル
└── README.md
```

## データベーススキーマ

### テーブル一覧

| テーブル名 | 説明 |
|-----------|------|
| users | ユーザー情報（認証用） |
| insulin_formulations | インスリン製剤マスタ |
| oral_antidiabetic_drugs | 経口血糖降下薬マスタ |
| glucose_containing_fluids | 糖含有輸液マスタ |
| ivh_formulations | IVH製剤マスタ |
| diabetes_classifications | 糖尿病分類マスタ |
| complications | 合併症マスタ |
| nephropathy_stages | 腎症ステージマスタ |

## セットアップと実行

### 必要な環境

- Node.js 22.13.0以上
- pnpm 10.4.1以上
- MySQL 8.0以上

### インストール

```bash
# リポジトリのクローン
git clone https://github.com/iwatatsu2/dm-compass.git
cd dm-compass

# 依存関係のインストール
pnpm install

# データベースマイグレーション
pnpm db:push
```

### 開発サーバーの起動

```bash
pnpm dev
```

ブラウザで `http://localhost:3000` にアクセスしてください。

### テストの実行

```bash
pnpm test
```

### ビルド

```bash
pnpm build
pnpm start
```

## 計算ロジック仕様

### 必要エネルギー計算

```
標準体重 = 身長(m)² × 22
1日必要カロリー = 標準体重 × 活動量係数
  - 安静：25 kcal/kg
  - 普通：30 kcal/kg
  - 高：35 kcal/kg
1食あたりカロリー = 1日必要カロリー ÷ 3
```

### 糖尿病性腎症ステージ判定

| ステージ | eGFR | 蛋白摂取量 |
|---------|------|----------|
| 第1期 | ≥90 | 0.8～1.0 g/kg |
| 第2期 | 60～89 | 0.8～1.0 g/kg |
| 第3期 | 30～59 | 0.8 g/kg |
| 第4期 | 15～29 | 0.6～0.8 g/kg |
| 第5期 | <15 | 0.6 g/kg |

### インスリン混注計算

**末梢輸液**：総糖量 ÷ 5g/単位、総糖量 ÷ 10g/単位
**IVH**：総糖量 ÷ 10g/単位、総糖量 ÷ 15g/単位（持続投与対応）

## 免責事項

本アプリは教育目的であり、最終的な治療判断は主治医の責任で行ってください。最新の添付文書をご確認ください。

## ライセンス

MIT License

## 開発者

Manus Team

## サポート

問題が見つかった場合は、GitHubのIssuesセクションで報告してください。

---

**最終更新日**：2026年2月27日
**バージョン**：1.0.0
